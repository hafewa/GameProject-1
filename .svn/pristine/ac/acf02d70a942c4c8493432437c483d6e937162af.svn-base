using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using UniLua;
using UnityEngine;


public class LuaEventCallback : IEventCallback
{ 
    internal void Init(int classRef, int funcRef)
    {
        m_ClassRef = classRef;
        m_FuncRef = funcRef;
    }

    public void Call(object param)
    {
        _Call(param);
    }

    protected virtual void _Call(object param)
    {
        LuaRoot.CallMember(m_FuncRef, m_ClassRef, param);
    }

    public void Dispose()
    {
        if (m_ClassRef > 0) { LuaRoot._Lua.L_Unref(LuaDef.LUA_REGISTRYINDEX, m_ClassRef); m_ClassRef = 0; }
        if (m_FuncRef > 0) { LuaRoot._Lua.L_Unref(LuaDef.LUA_REGISTRYINDEX, m_FuncRef); m_FuncRef = 0; }
    }

    protected int m_ClassRef;//lua类句柄
    protected int m_FuncRef;//lua函数句柄
}



